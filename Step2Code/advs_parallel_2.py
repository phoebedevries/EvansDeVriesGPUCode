import numpy as np
from pylab import *
import time

# Import the PyCUDA modules and initialize the CUDA device
import pycuda.autoinit
import pycuda.driver as cu
import pycuda.compiler as nvcc

def advs(y1vec, y2vec, y3vec, a, b, nu, B1, B2, B3):
      # These are the strains in a uniform elastic half space due to slip
      # on an angular dislocation.  They were calculated by symbolically
      # differentiating the expressions for the displacements (Comninou and
      # Dunders, 1.09.07.05.0, with typos noted by Thomas 1.09.09.03.0) then combining the
      # elements of the displacement gradient tensor to form the strain tensor.

# Define the CUDA saxpy kernel as a string.
     advs_kernel_source = \
"""

//#define next_im(i,j) next_im[(j) + (i)*width]

__global__ void advs_kernel( double* e11, double* e22, double* e33, double* e12, double* e13, double* e23, double* y1vec, double* y2vec, double* y3vec, double* avec, double* bvec, double nu, double* B1vec, double* B2vec, double* B3vec)
{
    //Here is the kernel
    int tid = blockIdx.x * blockDim.x + threadIdx.x;
    double a = avec[tid];
    double b = bvec[tid];
    double B1 = B1vec[tid];
    double B2 = B2vec[tid];
    double B3 = B3vec[tid];
    double sb=sin(b);
    double cb=cos(b);
    double pi =3.141592653589793;
    double cotb=1.0/tan(b);
    double y1 = y1vec[tid];
    double y2 = y2vec[tid];
    double y3 = y3vec[tid];
    double A=pow(y1,2.0);
    double B=pow(y2,2.0);
    double C=pow(y3,2.0);
    double D=pow(y1,3.0);
    double E=pow(y2,3.0);
    double K=pow(sb,2.0);
    double Q=pow(cb,2.0);
    double U=pow(cotb,2.0);
    double G=pow((y3+2.0*a),2.0);
    double T=pow((A+B+G),0.5);
    double I=pow((A+B+G),1.5);
    double J=pow((A+B+C),0.5);
    double L=pow((A+B+C),1.5);
    double M=pow((T+y3+2.0*a),2.0);
    double N=pow((y1*cb+(y3+2.0*a)*sb),2.0);
    double O=pow((y1*cb-y3*sb),2.0);
    double R=pow((y1*(y1*cb+(y3+2.0*a)*sb)+B*cb),2.0);
    double S=pow((T-y1*sb+(y3+2.0*a)*cb),2.0);
    double V=pow((A+B+G),(5.0/2.0));
    double X=pow((A+B+G),2.0);
    double Y=pow((J-y1*sb-y3*cb),2.0);
    double Z=pow((y1*(y1*cb-y3*sb)+B*cb),2.0);
    double BB=pow((J-y3),2.0);

e11[tid]=B1*(1.0/8.0*((2.0-2.0*nu)*(2.0*y2/A/(1.0+B/A)-y2/O*cb/(1.0+B/O)+(y2/J*sb/(y1*(y1*cb-y3*sb)+B*cb)*y1-y2*J*sb/Z*(2.0*y1*cb-y3*sb))/(1.0+B*(A+B+C)*K/Z)-y2/N*cb/(1.0+B/N)+(y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*y1-y2*T*sb/R*(2.0*y1*cb+(y3+2.0*a)*sb))/(1.0+B*(A+B+G)*K/R))-y2*(1.0/J/(J-y3)+1.0/T/(T+y3+2.0*a))-y1*y2*(-1.0/L/(J-y3)*y1-1.0/(A+B+C)/BB*y1-1.0/I/(T+y3+2.0*a)*y1-1.0/(A+B+G)/M*y1)-y2*cb*((1.0/J*sb*y1-1.0)/J/(J-y1*sb-y3*cb)-(J*sb-y1)/L/(J-y1*sb-y3*cb)*y1-(J*sb-y1)/J/Y*(1.0/J*y1-sb)+(1.0/T*sb*y1-1.0)/T/(T-y1*sb+(y3+2.0*a)*cb)-(T*sb-y1)/I/(T-y1*sb+(y3+2.0*a)*cb)*y1-(T*sb-y1)/T/S*(1.0/T*y1-sb)))/pi/(1.0-nu)+1.0/4.0*((-2.0+2.0*nu)*(1.0-2.0*nu)*(y2/A/(1.0+B/A)-y2/N*cb/(1.0+B/N)+(y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*y1-y2*T*sb/R*(2.0*y1*cb+(y3+2.0*a)*sb))/(1.0+B*(A+B+G)*K/R))*U-(1.0-2.0*nu)*y2/M*((1.0-2.0*nu-a/T)*cotb-y1/(T+y3+2.0*a)*(nu+a/T))/T*y1+(1.0-2.0*nu)*y2/(T+y3+2.0*a)*(a/I*y1*cotb-1.0/(T+y3+2.0*a)*(nu+a/T)+A/M*(nu+a/T)/T+A/(T+y3+2.0*a)*a/I)-(1.0-2.0*nu)*y2*cb*cotb/S*(cb+a/T)*(1.0/T*y1-sb)-(1.0-2.0*nu)*y2*cb*cotb/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y1-3.0*a*y2*(y3+a)*cotb/V*y1-y2*(y3+a)/I/(T+y3+2.0*a)*((-1.0+2.0*nu)*cotb+y1/(T+y3+2.0*a)*(2.0*nu+a/T)+a*y1/(A+B+G))*y1-y2*(y3+a)/(A+B+G)/M*((-1.0+2.0*nu)*cotb+y1/(T+y3+2.0*a)*(2.0*nu+a/T)+a*y1/(A+B+G))*y1+y2*(y3+a)/T/(T+y3+2.0*a)*(1.0/(T+y3+2.0*a)*(2.0*nu+a/T)-A/M*(2.0*nu+a/T)/T-A/(T+y3+2.0*a)*a/I+a/(A+B+G)-2.0*a*A/X)-y2*(y3+a)/I/(T-y1*sb+(y3+2.0*a)*cb)*(cb/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)*((1.0-2.0*nu)*cb-a/T)*cotb+(2.0-2.0*nu)*(T*sb-y1)*cb)-a*(y3+2.0*a)*cb*cotb/(A+B+G))*y1-y2*(y3+a)/T/S*(cb/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)*((1.0-2.0*nu)*cb-a/T)*cotb+(2.0-2.0*nu)*(T*sb-y1)*cb)-a*(y3+2.0*a)*cb*cotb/(A+B+G))*(1.0/T*y1-sb)+y2*(y3+a)/T/(T-y1*sb+(y3+2.0*a)*cb)*(-cb/S*((T*cb+y3+2.0*a)*((1.0-2.0*nu)*cb-a/T)*cotb+(2.0-2.0*nu)*(T*sb-y1)*cb)*(1.0/T*y1-sb)+cb/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/T*cb*y1*((1.0-2.0*nu)*cb-a/T)*cotb+(T*cb+y3+2.0*a)*a/I*y1*cotb+(2.0-2.0*nu)*(1.0/T*sb*y1-1.0)*cb)+2.0*a*(y3+2.0*a)*cb*cotb/X*y1))/pi/(1.0-nu))+B2*(1.0/8.0*((-1.0+2.0*nu)*(1.0/J*y1/(J-y3)+1.0/T*y1/(T+y3+2.0*a)-cb*((1.0/J*y1-sb)/(J-y1*sb-y3*cb)+(1.0/T*y1-sb)/(T-y1*sb+(y3+2.0*a)*cb)))+2.0*y1*(1.0/J/(J-y3)+1.0/T/(T+y3+2.0*a))+A*(-1.0/L/(J-y3)*y1-1.0/(A+B+C)/BB*y1-1.0/I/(T+y3+2.0*a)*y1-1.0/(A+B+G)/M*y1)+cb*(J*sb-y1)/J/(J-y1*sb-y3*cb)+(y1*cb-y3*sb)*(1.0/J*sb*y1-1.0)/J/(J-y1*sb-y3*cb)-(y1*cb-y3*sb)*(J*sb-y1)/L/(J-y1*sb-y3*cb)*y1-(y1*cb-y3*sb)*(J*sb-y1)/J/Y*(1.0/J*y1-sb)+cb*(T*sb-y1)/T/(T-y1*sb+(y3+2.0*a)*cb)+(y1*cb+(y3+2.0*a)*sb)*(1.0/T*sb*y1-1.0)/T/(T-y1*sb+(y3+2.0*a)*cb)-(y1*cb+(y3+2.0*a)*sb)*(T*sb-y1)/I/(T-y1*sb+(y3+2.0*a)*cb)*y1-(y1*cb+(y3+2.0*a)*sb)*(T*sb-y1)/T/S*(1.0/T*y1-sb))/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(((2.0-2.0*nu)*U+nu)/T*y1/(T+y3+2.0*a)-((2.0-2.0*nu)*U+1.0)*cb*(1.0/T*y1-sb)/(T-y1*sb+(y3+2.0*a)*cb))-(1.0-2.0*nu)/M*((-1.0+2.0*nu)*y1*cotb+nu*(y3+2.0*a)-a+a*y1*cotb/T+A/(T+y3+2.0*a)*(nu+a/T))/T*y1+(1.0-2.0*nu)/(T+y3+2.0*a)*((-1.0+2.0*nu)*cotb+a*cotb/T-a*A*cotb/I+2.0*y1/(T+y3+2.0*a)*(nu+a/T)-D/M*(nu+a/T)/T-D/(T+y3+2.0*a)*a/I)+(1.0-2.0*nu)*cotb/S*((y1*cb+(y3+2.0*a)*sb)*cb-a*(T*sb-y1)/T/cb)*(1.0/T*y1-sb)-(1.0-2.0*nu)*cotb/(T-y1*sb+(y3+2.0*a)*cb)*(Q-a*(1.0/T*sb*y1-1.0)/T/cb+a*(T*sb-y1)/I/cb*y1)-a*(y3+a)*cotb/I+3.0*a*A*(y3+a)*cotb/V-(y3+a)/M*(2.0*nu+1.0/T*((1.0-2.0*nu)*y1*cotb+a)-A/T/(T+y3+2.0*a)*(2.0*nu+a/T)-a*A/I)/T*y1+(y3+a)/(T+y3+2.0*a)*(-1.0/I*((1.0-2.0*nu)*y1*cotb+a)*y1+1.0/T*(1.0-2.0*nu)*cotb-2.0*y1/T/(T+y3+2.0*a)*(2.0*nu+a/T)+D/I/(T+y3+2.0*a)*(2.0*nu+a/T)+D/(A+B+G)/M*(2.0*nu+a/T)+D/X/(T+y3+2.0*a)*a-2.0*a/I*y1+3.0*a*D/V)-(y3+a)*cotb/S*(-cb*sb+a*y1*(y3+2.0*a)/I/cb+(T*sb-y1)/T*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)))*(1.0/T*y1-sb)+(y3+a)*cotb/(T-y1*sb+(y3+2.0*a)*cb)*(a*(y3+2.0*a)/I/cb-3.0*a*A*(y3+2.0*a)/V/cb+(1.0/T*sb*y1-1.0)/T*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb))-(T*sb-y1)/I*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb))*y1+(T*sb-y1)/T*(-1.0/T*cb*y1/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+(T*cb+y3+2.0*a)/S*(1.0+a/T/cb)*(1.0/T*y1-sb)+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I/cb*y1)))/pi/(1.0-nu))+B3*(1.0/8.0*y2*sb*((1.0/J*sb*y1-1.0)/J/(J-y1*sb-y3*cb)-(J*sb-y1)/L/(J-y1*sb-y3*cb)*y1-(J*sb-y1)/J/Y*(1.0/J*y1-sb)+(1.0/T*sb*y1-1.0)/T/(T-y1*sb+(y3+2.0*a)*cb)-(T*sb-y1)/I/(T-y1*sb+(y3+2.0*a)*cb)*y1-(T*sb-y1)/T/S*(1.0/T*y1-sb))/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(-y2/M*(1.0+a/T)/T*y1-y2/(T+y3+2.0*a)*a/I*y1+y2*cb/S*(cb+a/T)*(1.0/T*y1-sb)+y2*cb/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y1)+y2*(y3+a)/I*(a/(A+B+G)+1.0/(T+y3+2.0*a))*y1-y2*(y3+a)/T*(-2.0*a/X*y1-1.0/M/T*y1)-y2*(y3+a)*cb/I/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))*y1-y2*(y3+a)*cb/T/S*((T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))*(1.0/T*y1-sb)+y2*(y3+a)*cb/T/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/T*cb*y1/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(T*cb+y3+2.0*a)/S*(cb+a/T)*(1.0/T*y1-sb)-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y1-2.0*a*(y3+2.0*a)/X*y1))/pi/(1.0-nu));
           
      e22[tid]=B1*(1.0/8.0*((1.0-2.0*nu)*(1.0/J*y2/(J-y3)+1.0/T*y2/(T+y3+2.0*a)-cb*(1.0/J*y2/(J-y1*sb-y3*cb)+1.0/T*y2/(T-y1*sb+(y3+2.0*a)*cb)))-2.0*y2*(1.0/J/(J-y3)+1.0/T/(T+y3+2.0*a)-cb*(1.0/J/(J-y1*sb-y3*cb)+1.0/T/(T-y1*sb+(y3+2.0*a)*cb)))-B*(-1.0/L/(J-y3)*y2-1.0/(A+B+C)/BB*y2-1.0/I/(T+y3+2.0*a)*y2-1.0/(A+B+G)/M*y2-cb*(-1.0/L/(J-y1*sb-y3*cb)*y2-1.0/(A+B+C)/Y*y2-1.0/I/(T-y1*sb+(y3+2.0*a)*cb)*y2-1.0/(A+B+G)/S*y2)))/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(((2.0-2.0*nu)*U-nu)/T*y2/(T+y3+2.0*a)-((2.0-2.0*nu)*U+1.0-2.0*nu)*cb/T*y2/(T-y1*sb+(y3+2.0*a)*cb))+(1.0-2.0*nu)/M*(y1*cotb*(1.0-2.0*nu-a/T)+nu*(y3+2.0*a)-a+B/(T+y3+2.0*a)*(nu+a/T))/T*y2-(1.0-2.0*nu)/(T+y3+2.0*a)*(a*y1*cotb/I*y2+2.0*y2/(T+y3+2.0*a)*(nu+a/T)-E/M*(nu+a/T)/T-E/(T+y3+2.0*a)*a/I)+(1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb/S*(cb+a/T)/T*y2+(1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y2+3.0*a*y2*(y3+a)*cotb/V*y1-(y3+a)/M*(-2.0*nu+1.0/T*((1.0-2.0*nu)*y1*cotb-a)+B/T/(T+y3+2.0*a)*(2.0*nu+a/T)+a*B/I)/T*y2+(y3+a)/(T+y3+2.0*a)*(-1.0/I*((1.0-2.0*nu)*y1*cotb-a)*y2+2.0*y2/T/(T+y3+2.0*a)*(2.0*nu+a/T)-E/I/(T+y3+2.0*a)*(2.0*nu+a/T)-E/(A+B+G)/M*(2.0*nu+a/T)-E/X/(T+y3+2.0*a)*a+2.0*a/I*y2-3.0*a*E/V)-(y3+a)/S*(Q-1.0/T*((1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb+a*cb)+a*(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)*cotb/I-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(B*Q-a*(y1*cb+(y3+2.0*a)*sb)*cotb/T*(T*cb+y3+2.0*a)))/T*y2+(y3+a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/I*((1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb+a*cb)*y2-3.0*a*(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)*cotb/V*y2+1.0/I/(T-y1*sb+(y3+2.0*a)*cb)*(B*Q-a*(y1*cb+(y3+2.0*a)*sb)*cotb/T*(T*cb+y3+2.0*a))*y2+1.0/(A+B+G)/S*(B*Q-a*(y1*cb+(y3+2.0*a)*sb)*cotb/T*(T*cb+y3+2.0*a))*y2-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y2*Q+a*(y1*cb+(y3+2.0*a)*sb)*cotb/I*(T*cb+y3+2.0*a)*y2-a*(y1*cb+(y3+2.0*a)*sb)*cotb/(A+B+G)*cb*y2)))/pi/(1.0-nu))+B2*(1.0/8.0*((2.0-2.0*nu)*(-2.0/y1/(1.0+B/A)+1.0/(y1*cb-y3*sb)/(1.0+B/O)+(J*sb/(y1*(y1*cb-y3*sb)+B*cb)+B/J*sb/(y1*(y1*cb-y3*sb)+B*cb)-2.0*B*J*sb/Z*cb)/(1.0+B*(A+B+C)*K/Z)+1.0/(y1*cb+(y3+2.0*a)*sb)/(1.0+B/N)+(T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)+B/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)-2.0*B*T*sb/R*cb)/(1.0+B*(A+B+G)*K/R))+y1*(1.0/J/(J-y3)+1.0/T/(T+y3+2.0*a))+y1*y2*(-1.0/L/(J-y3)*y2-1.0/(A+B+C)/BB*y2-1.0/I/(T+y3+2.0*a)*y2-1.0/(A+B+G)/M*y2)-(y1*cb-y3*sb)/J/(J-y1*sb-y3*cb)-(y1*cb+(y3+2.0*a)*sb)/T/(T-y1*sb+(y3+2.0*a)*cb)-y2*(-(y1*cb-y3*sb)/L/(J-y1*sb-y3*cb)*y2-(y1*cb-y3*sb)/(A+B+C)/Y*y2-(y1*cb+(y3+2.0*a)*sb)/I/(T-y1*sb+(y3+2.0*a)*cb)*y2-(y1*cb+(y3+2.0*a)*sb)/(A+B+G)/S*y2))/pi/(1.0-nu)+1.0/4.0*((2.0-2.0*nu)*(1.0-2.0*nu)*(-1.0/y1/(1.0+B/A)+1.0/(y1*cb+(y3+2.0*a)*sb)/(1.0+B/N)+(T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)+B/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)-2.0*B*T*sb/R*cb)/(1.0+B*(A+B+G)*K/R))*U+(1.0-2.0*nu)/(T+y3+2.0*a)*((-1.0+2.0*nu+a/T)*cotb+y1/(T+y3+2.0*a)*(nu+a/T))-(1.0-2.0*nu)*B/M*((-1.0+2.0*nu+a/T)*cotb+y1/(T+y3+2.0*a)*(nu+a/T))/T+(1.0-2.0*nu)*y2/(T+y3+2.0*a)*(-a/I*y2*cotb-y1/M*(nu+a/T)/T*y2-y2/(T+y3+2.0*a)*a/I*y1)-(1.0-2.0*nu)*cotb/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+(1.0-2.0*nu)*B*cotb/S*(1.0+a/T/cb)/T+(1.0-2.0*nu)*B*cotb/(T-y1*sb+(y3+2.0*a)*cb)*a/I/cb-a*(y3+a)*cotb/I+3.0*a*B*(y3+a)*cotb/V+(y3+a)/T/(T+y3+2.0*a)*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/T*(1.0/T+1.0/(T+y3+2.0*a)))-B*(y3+a)/I/(T+y3+2.0*a)*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/T*(1.0/T+1.0/(T+y3+2.0*a)))-B*(y3+a)/(A+B+G)/M*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/T*(1.0/T+1.0/(T+y3+2.0*a)))+y2*(y3+a)/T/(T+y3+2.0*a)*(2.0*nu*y1/M/T*y2+a*y1/I*(1.0/T+1.0/(T+y3+2.0*a))*y2-a*y1/T*(-1.0/I*y2-1.0/M/T*y2))+(y3+a)*cotb/T/(T-y1*sb+(y3+2.0*a)*cb)*((-2.0+2.0*nu)*cb+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+a*(y3+2.0*a)/(A+B+G)/cb)-B*(y3+a)*cotb/I/(T-y1*sb+(y3+2.0*a)*cb)*((-2.0+2.0*nu)*cb+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+a*(y3+2.0*a)/(A+B+G)/cb)-B*(y3+a)*cotb/(A+B+G)/S*((-2.0+2.0*nu)*cb+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+a*(y3+2.0*a)/(A+B+G)/cb)+y2*(y3+a)*cotb/T/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/T*cb*y2/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)-(T*cb+y3+2.0*a)/S*(1.0+a/T/cb)/T*y2-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I/cb*y2-2.0*a*(y3+2.0*a)/X/cb*y2))/pi/(1.0-nu))+B3*(1.0/8.0*((1.0-2.0*nu)*sb*(1.0/J*y2/(J-y1*sb-y3*cb)+1.0/T*y2/(T-y1*sb+(y3+2.0*a)*cb))-2.0*y2*sb*(1.0/J/(J-y1*sb-y3*cb)+1.0/T/(T-y1*sb+(y3+2.0*a)*cb))-B*sb*(-1.0/L/(J-y1*sb-y3*cb)*y2-1.0/(A+B+C)/Y*y2-1.0/I/(T-y1*sb+(y3+2.0*a)*cb)*y2-1.0/(A+B+G)/S*y2))/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(-sb/T*y2/(T-y1*sb+(y3+2.0*a)*cb)+y2/M*(1.0+a/T)/T*y1+y2/(T+y3+2.0*a)*a/I*y1-(y1*cb+(y3+2.0*a)*sb)/S*(cb+a/T)/T*y2-(y1*cb+(y3+2.0*a)*sb)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y2)-y2*(y3+a)/I*(a/(A+B+G)+1.0/(T+y3+2.0*a))*y1+y1*(y3+a)/T*(-2.0*a/X*y2-1.0/M/T*y2)+(y3+a)/S*(sb*(cb-a/T)+(y1*cb+(y3+2.0*a)*sb)/T*(1.0+a*(y3+2.0*a)/(A+B+G))-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(B*cb*sb-a*(y1*cb+(y3+2.0*a)*sb)/T*(T*cb+y3+2.0*a)))/T*y2-(y3+a)/(T-y1*sb+(y3+2.0*a)*cb)*(sb*a/I*y2-(y1*cb+(y3+2.0*a)*sb)/I*(1.0+a*(y3+2.0*a)/(A+B+G))*y2-2.0*(y1*cb+(y3+2.0*a)*sb)/V*a*(y3+2.0*a)*y2+1.0/I/(T-y1*sb+(y3+2.0*a)*cb)*(B*cb*sb-a*(y1*cb+(y3+2.0*a)*sb)/T*(T*cb+y3+2.0*a))*y2+1.0/(A+B+G)/S*(B*cb*sb-a*(y1*cb+(y3+2.0*a)*sb)/T*(T*cb+y3+2.0*a))*y2-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y2*cb*sb+a*(y1*cb+(y3+2.0*a)*sb)/I*(T*cb+y3+2.0*a)*y2-a*(y1*cb+(y3+2.0*a)*sb)/(A+B+G)*cb*y2)))/pi/(1.0-nu));

      e33[tid]=B1*(1.0/8.0*y2*(-1.0/L*y3+1.0/2.0/I*(2.0*y3+4.0*a)-cb*((1.0/J*cb*y3-1.0)/J/(J-y1*sb-y3*cb)-(J*cb-y3)/L/(J-y1*sb-y3*cb)*y3-(J*cb-y3)/J/Y*(1.0/J*y3-cb)-(1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)/T/(T-y1*sb+(y3+2.0*a)*cb)+1.0/2.0*(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y3+4.0*a)+(T*cb+y3+2.0*a)/T/S*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)))/pi/(1.0-nu)+1.0/4.0*((2.0-2.0*nu)*((1.0-2.0*nu)*(-y2/N*sb/(1.0+B/N)+(1.0/2.0*y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*(2.0*y3+4.0*a)-y2*T*K/R*y1)/(1.0+B*(A+B+G)*K/R))*cotb-y2/M*(2.0*nu+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)-1.0/2.0*y2/(T+y3+2.0*a)*a/I*(2.0*y3+4.0*a)+y2*cb/S*(cb+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+1.0/2.0*y2*cb/(T-y1*sb+(y3+2.0*a)*cb)*a/I*(2.0*y3+4.0*a))+y2/T*(2.0*nu/(T+y3+2.0*a)+a/(A+B+G))-1.0/2.0*y2*(y3+a)/I*(2.0*nu/(T+y3+2.0*a)+a/(A+B+G))*(2.0*y3+4.0*a)+y2*(y3+a)/T*(-2.0*nu/M*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)-a/X*(2.0*y3+4.0*a))+y2*cb/T/(T-y1*sb+(y3+2.0*a)*cb)*(1.0-2.0*nu-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-a*(y3+2.0*a)/(A+B+G))-1.0/2.0*y2*(y3+a)*cb/I/(T-y1*sb+(y3+2.0*a)*cb)*(1.0-2.0*nu-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-a*(y3+2.0*a)/(A+B+G))*(2.0*y3+4.0*a)-y2*(y3+a)*cb/T/S*(1.0-2.0*nu-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-a*(y3+2.0*a)/(A+B+G))*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+y2*(y3+a)*cb/T/(T-y1*sb+(y3+2.0*a)*cb)*(-(1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+(T*cb+y3+2.0*a)/S*(cb+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+1.0/2.0*(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*(2.0*y3+4.0*a)-a/(A+B+G)+a*(y3+2.0*a)/X*(2.0*y3+4.0*a)))/pi/(1.0-nu))+B2*(1.0/8.0*((-1.0+2.0*nu)*sb*((1.0/J*y3-cb)/(J-y1*sb-y3*cb)-(1.0/2.0/T*(2.0*y3+4.0*a)+cb)/(T-y1*sb+(y3+2.0*a)*cb))-y1*(-1.0/L*y3+1.0/2.0/I*(2.0*y3+4.0*a))-sb*(J*cb-y3)/J/(J-y1*sb-y3*cb)+(y1*cb-y3*sb)*(1.0/J*cb*y3-1.0)/J/(J-y1*sb-y3*cb)-(y1*cb-y3*sb)*(J*cb-y3)/L/(J-y1*sb-y3*cb)*y3-(y1*cb-y3*sb)*(J*cb-y3)/J/Y*(1.0/J*y3-cb)-sb*(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb)-(y1*cb+(y3+2.0*a)*sb)*(1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)/T/(T-y1*sb+(y3+2.0*a)*cb)+1.0/2.0*(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y3+4.0*a)+(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/T/S*(1.0/2.0/T*(2.0*y3+4.0*a)+cb))/pi/(1.0-nu)+1.0/4.0*((-2.0+2.0*nu)*(1.0-2.0*nu)*cotb*((1.0/2.0/T*(2.0*y3+4.0*a)+1.0)/(T+y3+2.0*a)-cb*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)/(T-y1*sb+(y3+2.0*a)*cb))+(2.0-2.0*nu)*y1/M*(2.0*nu+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+1.0/2.0*(2.0-2.0*nu)*y1/(T+y3+2.0*a)*a/I*(2.0*y3+4.0*a)+(2.0-2.0*nu)*sb/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(2.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)/S*(cb+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-1.0/2.0*(2.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*(2.0*y3+4.0*a)+1.0/T*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/(A+B+G))-1.0/2.0*(y3+a)/I*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/(A+B+G))*(2.0*y3+4.0*a)+(y3+a)/T*(2.0*nu*y1/M*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+a*y1/X*(2.0*y3+4.0*a))-1.0/(T-y1*sb+(y3+2.0*a)*cb)*(cb*sb+(T*cb+y3+2.0*a)*cotb/T*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb))+a/T*(sb-(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)/(A+B+G)-(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb)))+(y3+a)/S*(cb*sb+(T*cb+y3+2.0*a)*cotb/T*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb))+a/T*(sb-(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)/(A+B+G)-(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb)))*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-(y3+a)/(T-y1*sb+(y3+2.0*a)*cb)*((1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)*cotb/T*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb))-1.0/2.0*(T*cb+y3+2.0*a)*cotb/I*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb))*(2.0*y3+4.0*a)+(T*cb+y3+2.0*a)*cotb/T*(-(1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)/(T-y1*sb+(y3+2.0*a)*cb)+(T*cb+y3+2.0*a)/S*(1.0/2.0/T*(2.0*y3+4.0*a)+cb))-1.0/2.0*a/I*(sb-(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)/(A+B+G)-(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb))*(2.0*y3+4.0*a)+a/T*(-(y1*cb+(y3+2.0*a)*sb)/(A+B+G)-(y3+2.0*a)*sb/(A+B+G)+(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)/X*(2.0*y3+4.0*a)-sb*(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb)-(y1*cb+(y3+2.0*a)*sb)*(1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)/T/(T-y1*sb+(y3+2.0*a)*cb)+1.0/2.0*(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y3+4.0*a)+(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/T/S*(1.0/2.0/T*(2.0*y3+4.0*a)+cb))))/pi/(1.0-nu))+B3*(1.0/8.0*((2.0-2.0*nu)*(y2/O*sb/(1.0+B/O)+(y2/J*sb/(y1*(y1*cb-y3*sb)+B*cb)*y3+y2*J*K/Z*y1)/(1.0+B*(A+B+C)*K/Z)+y2/N*sb/(1.0+B/N)-(1.0/2.0*y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*(2.0*y3+4.0*a)-y2*T*K/R*y1)/(1.0+B*(A+B+G)*K/R))+y2*sb*((1.0/J*cb*y3-1.0)/J/(J-y1*sb-y3*cb)-(J*cb-y3)/L/(J-y1*sb-y3*cb)*y3-(J*cb-y3)/J/Y*(1.0/J*y3-cb)-(1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)/T/(T-y1*sb+(y3+2.0*a)*cb)+1.0/2.0*(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y3+4.0*a)+(T*cb+y3+2.0*a)/T/S*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)))/pi/(1.0-nu)+1.0/4.0*((2.0-2.0*nu)*(-y2/N*sb/(1.0+B/N)+(1.0/2.0*y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*(2.0*y3+4.0*a)-y2*T*K/R*y1)/(1.0+B*(A+B+G)*K/R))-(2.0-2.0*nu)*y2*sb/S*(cb+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-1.0/2.0*(2.0-2.0*nu)*y2*sb/(T-y1*sb+(y3+2.0*a)*cb)*a/I*(2.0*y3+4.0*a)+y2*sb/T/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))-1.0/2.0*y2*(y3+a)*sb/I/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))*(2.0*y3+4.0*a)-y2*(y3+a)*sb/T/S*(1.0+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+y2*(y3+a)*sb/T/(T-y1*sb+(y3+2.0*a)*cb)*((1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(T*cb+y3+2.0*a)/S*(cb+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-1.0/2.0*(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*(2.0*y3+4.0*a)+a/(A+B+G)-a*(y3+2.0*a)/X*(2.0*y3+4.0*a)))/pi/(1.0-nu));

      e12[tid]=1.0/2.0*B1*(1.0/8.0*((2.0-2.0*nu)*(-2.0/y1/(1.0+B/A)+1.0/(y1*cb-y3*sb)/(1.0+B/O)+(J*sb/(y1*(y1*cb-y3*sb)+B*cb)+B/J*sb/(y1*(y1*cb-y3*sb)+B*cb)-2.0*B*J*sb/Z*cb)/(1.0+B*(A+B+C)*K/Z)+1.0/(y1*cb+(y3+2.0*a)*sb)/(1.0+B/N)+(T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)+B/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)-2.0*B*T*sb/R*cb)/(1.0+B*(A+B+G)*K/R))-y1*(1.0/J/(J-y3)+1.0/T/(T+y3+2.0*a))-y1*y2*(-1.0/L/(J-y3)*y2-1.0/(A+B+C)/BB*y2-1.0/I/(T+y3+2.0*a)*y2-1.0/(A+B+G)/M*y2)-cb*((J*sb-y1)/J/(J-y1*sb-y3*cb)+(T*sb-y1)/T/(T-y1*sb+(y3+2.0*a)*cb))-y2*cb*(1.0/(A+B+C)*sb*y2/(J-y1*sb-y3*cb)-(J*sb-y1)/L/(J-y1*sb-y3*cb)*y2-(J*sb-y1)/(A+B+C)/Y*y2+1.0/(A+B+G)*sb*y2/(T-y1*sb+(y3+2.0*a)*cb)-(T*sb-y1)/I/(T-y1*sb+(y3+2.0*a)*cb)*y2-(T*sb-y1)/(A+B+G)/S*y2))/pi/(1.0-nu)+1.0/4.0*((-2.0+2.0*nu)*(1.0-2.0*nu)*(-1.0/y1/(1.0+B/A)+1.0/(y1*cb+(y3+2.0*a)*sb)/(1.0+B/N)+(T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)+B/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)-2.0*B*T*sb/R*cb)/(1.0+B*(A+B+G)*K/R))*U+(1.0-2.0*nu)/(T+y3+2.0*a)*((1.0-2.0*nu-a/T)*cotb-y1/(T+y3+2.0*a)*(nu+a/T))-(1.0-2.0*nu)*B/M*((1.0-2.0*nu-a/T)*cotb-y1/(T+y3+2.0*a)*(nu+a/T))/T+(1.0-2.0*nu)*y2/(T+y3+2.0*a)*(a/I*y2*cotb+y1/M*(nu+a/T)/T*y2+y2/(T+y3+2.0*a)*a/I*y1)+(1.0-2.0*nu)*cb*cotb/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(1.0-2.0*nu)*B*cb*cotb/S*(cb+a/T)/T-(1.0-2.0*nu)*B*cb*cotb/(T-y1*sb+(y3+2.0*a)*cb)*a/I+a*(y3+a)*cotb/I-3.0*a*B*(y3+a)*cotb/V+(y3+a)/T/(T+y3+2.0*a)*((-1.0+2.0*nu)*cotb+y1/(T+y3+2.0*a)*(2.0*nu+a/T)+a*y1/(A+B+G))-B*(y3+a)/I/(T+y3+2.0*a)*((-1.0+2.0*nu)*cotb+y1/(T+y3+2.0*a)*(2.0*nu+a/T)+a*y1/(A+B+G))-B*(y3+a)/(A+B+G)/M*((-1.0+2.0*nu)*cotb+y1/(T+y3+2.0*a)*(2.0*nu+a/T)+a*y1/(A+B+G))+y2*(y3+a)/T/(T+y3+2.0*a)*(-y1/M*(2.0*nu+a/T)/T*y2-y2/(T+y3+2.0*a)*a/I*y1-2.0*a*y1/X*y2)+(y3+a)/T/(T-y1*sb+(y3+2.0*a)*cb)*(cb/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)*((1.0-2.0*nu)*cb-a/T)*cotb+(2.0-2.0*nu)*(T*sb-y1)*cb)-a*(y3+2.0*a)*cb*cotb/(A+B+G))-B*(y3+a)/I/(T-y1*sb+(y3+2.0*a)*cb)*(cb/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)*((1.0-2.0*nu)*cb-a/T)*cotb+(2.0-2.0*nu)*(T*sb-y1)*cb)-a*(y3+2.0*a)*cb*cotb/(A+B+G))-B*(y3+a)/(A+B+G)/S*(cb/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)*((1.0-2.0*nu)*cb-a/T)*cotb+(2.0-2.0*nu)*(T*sb-y1)*cb)-a*(y3+2.0*a)*cb*cotb/(A+B+G))+y2*(y3+a)/T/(T-y1*sb+(y3+2.0*a)*cb)*(-cb/S*((T*cb+y3+2.0*a)*((1.0-2.0*nu)*cb-a/T)*cotb+(2.0-2.0*nu)*(T*sb-y1)*cb)/T*y2+cb/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/T*cb*y2*((1.0-2.0*nu)*cb-a/T)*cotb+(T*cb+y3+2.0*a)*a/I*y2*cotb+(2.0-2.0*nu)/T*sb*y2*cb)+2.0*a*(y3+2.0*a)*cb*cotb/X*y2))/pi/(1.0-nu))+1.0/2.0*B2*(1.0/8.0*((-1.0+2.0*nu)*(1.0/J*y2/(J-y3)+1.0/T*y2/(T+y3+2.0*a)-cb*(1.0/J*y2/(J-y1*sb-y3*cb)+1.0/T*y2/(T-y1*sb+(y3+2.0*a)*cb)))+A*(-1.0/L/(J-y3)*y2-1.0/(A+B+C)/BB*y2-1.0/I/(T+y3+2.0*a)*y2-1.0/(A+B+G)/M*y2)+(y1*cb-y3*sb)/(A+B+C)*sb*y2/(J-y1*sb-y3*cb)-(y1*cb-y3*sb)*(J*sb-y1)/L/(J-y1*sb-y3*cb)*y2-(y1*cb-y3*sb)*(J*sb-y1)/(A+B+C)/Y*y2+(y1*cb+(y3+2.0*a)*sb)/(A+B+G)*sb*y2/(T-y1*sb+(y3+2.0*a)*cb)-(y1*cb+(y3+2.0*a)*sb)*(T*sb-y1)/I/(T-y1*sb+(y3+2.0*a)*cb)*y2-(y1*cb+(y3+2.0*a)*sb)*(T*sb-y1)/(A+B+G)/S*y2)/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(((2.0-2.0*nu)*U+nu)/T*y2/(T+y3+2.0*a)-((2.0-2.0*nu)*U+1.0)*cb/T*y2/(T-y1*sb+(y3+2.0*a)*cb))-(1.0-2.0*nu)/M*((-1.0+2.0*nu)*y1*cotb+nu*(y3+2.0*a)-a+a*y1*cotb/T+A/(T+y3+2.0*a)*(nu+a/T))/T*y2+(1.0-2.0*nu)/(T+y3+2.0*a)*(-a*y1*cotb/I*y2-A/M*(nu+a/T)/T*y2-A/(T+y3+2.0*a)*a/I*y2)+(1.0-2.0*nu)*cotb/S*((y1*cb+(y3+2.0*a)*sb)*cb-a*(T*sb-y1)/T/cb)/T*y2-(1.0-2.0*nu)*cotb/(T-y1*sb+(y3+2.0*a)*cb)*(-a/(A+B+G)*sb*y2/cb+a*(T*sb-y1)/I/cb*y2)+3.0*a*y2*(y3+a)*cotb/V*y1-(y3+a)/M*(2.0*nu+1.0/T*((1.0-2.0*nu)*y1*cotb+a)-A/T/(T+y3+2.0*a)*(2.0*nu+a/T)-a*A/I)/T*y2+(y3+a)/(T+y3+2.0*a)*(-1.0/I*((1.0-2.0*nu)*y1*cotb+a)*y2+A/I/(T+y3+2.0*a)*(2.0*nu+a/T)*y2+A/(A+B+G)/M*(2.0*nu+a/T)*y2+A/X/(T+y3+2.0*a)*a*y2+3.0*a*A/V*y2)-(y3+a)*cotb/S*(-cb*sb+a*y1*(y3+2.0*a)/I/cb+(T*sb-y1)/T*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)))/T*y2+(y3+a)*cotb/(T-y1*sb+(y3+2.0*a)*cb)*(-3.0*a*y1*(y3+2.0*a)/V/cb*y2+1.0/(A+B+G)*sb*y2*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb))-(T*sb-y1)/I*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb))*y2+(T*sb-y1)/T*(-1.0/T*cb*y2/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+(T*cb+y3+2.0*a)/S*(1.0+a/T/cb)/T*y2+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I/cb*y2)))/pi/(1.0-nu))+1.0/2.0*B3*(1.0/8.0*sb*((J*sb-y1)/J/(J-y1*sb-y3*cb)+(T*sb-y1)/T/(T-y1*sb+(y3+2.0*a)*cb))/pi/(1.0-nu)+1.0/8.0*y2*sb*(1.0/(A+B+C)*sb*y2/(J-y1*sb-y3*cb)-(J*sb-y1)/L/(J-y1*sb-y3*cb)*y2-(J*sb-y1)/(A+B+C)/Y*y2+1.0/(A+B+G)*sb*y2/(T-y1*sb+(y3+2.0*a)*cb)-(T*sb-y1)/I/(T-y1*sb+(y3+2.0*a)*cb)*y2-(T*sb-y1)/(A+B+G)/S*y2)/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(1.0/(T+y3+2.0*a)*(1.0+a/T)-B/M*(1.0+a/T)/T-B/(T+y3+2.0*a)*a/I-cb/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+B*cb/S*(cb+a/T)/T+B*cb/(T-y1*sb+(y3+2.0*a)*cb)*a/I)-(y3+a)/T*(a/(A+B+G)+1.0/(T+y3+2.0*a))+B*(y3+a)/I*(a/(A+B+G)+1.0/(T+y3+2.0*a))-y2*(y3+a)/T*(-2.0*a/X*y2-1.0/M/T*y2)+(y3+a)*cb/T/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))-B*(y3+a)*cb/I/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))-B*(y3+a)*cb/(A+B+G)/S*((T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))+y2*(y3+a)*cb/T/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/T*cb*y2/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(T*cb+y3+2.0*a)/S*(cb+a/T)/T*y2-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y2-2.0*a*(y3+2.0*a)/X*y2))/pi/(1.0-nu))+1.0/2.0*B1*(1.0/8.0*((1.0-2.0*nu)*(1.0/J*y1/(J-y3)+1.0/T*y1/(T+y3+2.0*a)-cb*((1.0/J*y1-sb)/(J-y1*sb-y3*cb)+(1.0/T*y1-sb)/(T-y1*sb+(y3+2.0*a)*cb)))-B*(-1.0/L/(J-y3)*y1-1.0/(A+B+C)/BB*y1-1.0/I/(T+y3+2.0*a)*y1-1.0/(A+B+G)/M*y1-cb*(-1.0/L/(J-y1*sb-y3*cb)*y1-1.0/J/Y*(1.0/J*y1-sb)-1.0/I/(T-y1*sb+(y3+2.0*a)*cb)*y1-1.0/T/S*(1.0/T*y1-sb))))/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(((2.0-2.0*nu)*U-nu)/T*y1/(T+y3+2.0*a)-((2.0-2.0*nu)*U+1.0-2.0*nu)*cb*(1.0/T*y1-sb)/(T-y1*sb+(y3+2.0*a)*cb))+(1.0-2.0*nu)/M*(y1*cotb*(1.0-2.0*nu-a/T)+nu*(y3+2.0*a)-a+B/(T+y3+2.0*a)*(nu+a/T))/T*y1-(1.0-2.0*nu)/(T+y3+2.0*a)*((1.0-2.0*nu-a/T)*cotb+a*A*cotb/I-B/M*(nu+a/T)/T*y1-B/(T+y3+2.0*a)*a/I*y1)-(1.0-2.0*nu)*cb*cotb/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+(1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb/S*(cb+a/T)*(1.0/T*y1-sb)+(1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y1-a*(y3+a)*cotb/I+3.0*a*A*(y3+a)*cotb/V-(y3+a)/M*(-2.0*nu+1.0/T*((1.0-2.0*nu)*y1*cotb-a)+B/T/(T+y3+2.0*a)*(2.0*nu+a/T)+a*B/I)/T*y1+(y3+a)/(T+y3+2.0*a)*(-1.0/I*((1.0-2.0*nu)*y1*cotb-a)*y1+1.0/T*(1.0-2.0*nu)*cotb-B/I/(T+y3+2.0*a)*(2.0*nu+a/T)*y1-B/(A+B+G)/M*(2.0*nu+a/T)*y1-B/X/(T+y3+2.0*a)*a*y1-3.0*a*B/V*y1)-(y3+a)/S*(Q-1.0/T*((1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb+a*cb)+a*(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)*cotb/I-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(B*Q-a*(y1*cb+(y3+2.0*a)*sb)*cotb/T*(T*cb+y3+2.0*a)))*(1.0/T*y1-sb)+(y3+a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/I*((1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb+a*cb)*y1-1.0/T*(1.0-2.0*nu)*cb*cotb+a*(y3+2.0*a)*cb*cotb/I-3.0*a*(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)*cotb/V*y1+1.0/I/(T-y1*sb+(y3+2.0*a)*cb)*(B*Q-a*(y1*cb+(y3+2.0*a)*sb)*cotb/T*(T*cb+y3+2.0*a))*y1+1.0/T/S*(B*Q-a*(y1*cb+(y3+2.0*a)*sb)*cotb/T*(T*cb+y3+2.0*a))*(1.0/T*y1-sb)-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(-a*cb*cotb/T*(T*cb+y3+2.0*a)+a*(y1*cb+(y3+2.0*a)*sb)*cotb/I*(T*cb+y3+2.0*a)*y1-a*(y1*cb+(y3+2.0*a)*sb)*cotb/(A+B+G)*cb*y1)))/pi/(1.0-nu))+1.0/2.0*B2*(1.0/8.0*((2.0-2.0*nu)*(2.0*y2/A/(1.0+B/A)-y2/O*cb/(1.0+B/O)+(y2/J*sb/(y1*(y1*cb-y3*sb)+B*cb)*y1-y2*J*sb/Z*(2.0*y1*cb-y3*sb))/(1.0+B*(A+B+C)*K/Z)-y2/N*cb/(1.0+B/N)+(y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*y1-y2*T*sb/R*(2.0*y1*cb+(y3+2.0*a)*sb))/(1.0+B*(A+B+G)*K/R))+y2*(1.0/J/(J-y3)+1.0/T/(T+y3+2.0*a))+y1*y2*(-1.0/L/(J-y3)*y1-1.0/(A+B+C)/BB*y1-1.0/I/(T+y3+2.0*a)*y1-1.0/(A+B+G)/M*y1)-y2*(cb/J/(J-y1*sb-y3*cb)-(y1*cb-y3*sb)/L/(J-y1*sb-y3*cb)*y1-(y1*cb-y3*sb)/J/Y*(1.0/J*y1-sb)+cb/T/(T-y1*sb+(y3+2.0*a)*cb)-(y1*cb+(y3+2.0*a)*sb)/I/(T-y1*sb+(y3+2.0*a)*cb)*y1-(y1*cb+(y3+2.0*a)*sb)/T/S*(1.0/T*y1-sb)))/pi/(1.0-nu)+1.0/4.0*((2.0-2.0*nu)*(1.0-2.0*nu)*(y2/A/(1.0+B/A)-y2/N*cb/(1.0+B/N)+(y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*y1-y2*T*sb/R*(2.0*y1*cb+(y3+2.0*a)*sb))/(1.0+B*(A+B+G)*K/R))*U-(1.0-2.0*nu)*y2/M*((-1.0+2.0*nu+a/T)*cotb+y1/(T+y3+2.0*a)*(nu+a/T))/T*y1+(1.0-2.0*nu)*y2/(T+y3+2.0*a)*(-a/I*y1*cotb+1.0/(T+y3+2.0*a)*(nu+a/T)-A/M*(nu+a/T)/T-A/(T+y3+2.0*a)*a/I)+(1.0-2.0*nu)*y2*cotb/S*(1.0+a/T/cb)*(1.0/T*y1-sb)+(1.0-2.0*nu)*y2*cotb/(T-y1*sb+(y3+2.0*a)*cb)*a/I/cb*y1+3.0*a*y2*(y3+a)*cotb/V*y1-y2*(y3+a)/I/(T+y3+2.0*a)*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/T*(1.0/T+1.0/(T+y3+2.0*a)))*y1-y2*(y3+a)/(A+B+G)/M*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/T*(1.0/T+1.0/(T+y3+2.0*a)))*y1+y2*(y3+a)/T/(T+y3+2.0*a)*(-2.0*nu/(T+y3+2.0*a)+2.0*nu*A/M/T-a/T*(1.0/T+1.0/(T+y3+2.0*a))+a*A/I*(1.0/T+1.0/(T+y3+2.0*a))-a*y1/T*(-1.0/I*y1-1.0/M/T*y1))-y2*(y3+a)*cotb/I/(T-y1*sb+(y3+2.0*a)*cb)*((-2.0+2.0*nu)*cb+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+a*(y3+2.0*a)/(A+B+G)/cb)*y1-y2*(y3+a)*cotb/T/S*((-2.0+2.0*nu)*cb+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+a*(y3+2.0*a)/(A+B+G)/cb)*(1.0/T*y1-sb)+y2*(y3+a)*cotb/T/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/T*cb*y1/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)-(T*cb+y3+2.0*a)/S*(1.0+a/T/cb)*(1.0/T*y1-sb)-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I/cb*y1-2.0*a*(y3+2.0*a)/X/cb*y1))/pi/(1.0-nu))+1.0/2.0*B3*(1.0/8.0*((1.0-2.0*nu)*sb*((1.0/J*y1-sb)/(J-y1*sb-y3*cb)+(1.0/T*y1-sb)/(T-y1*sb+(y3+2.0*a)*cb))-B*sb*(-1.0/L/(J-y1*sb-y3*cb)*y1-1.0/J/Y*(1.0/J*y1-sb)-1.0/I/(T-y1*sb+(y3+2.0*a)*cb)*y1-1.0/T/S*(1.0/T*y1-sb)))/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(-sb*(1.0/T*y1-sb)/(T-y1*sb+(y3+2.0*a)*cb)-1.0/(T+y3+2.0*a)*(1.0+a/T)+A/M*(1.0+a/T)/T+A/(T+y3+2.0*a)*a/I+cb/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(y1*cb+(y3+2.0*a)*sb)/S*(cb+a/T)*(1.0/T*y1-sb)-(y1*cb+(y3+2.0*a)*sb)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y1)+(y3+a)/T*(a/(A+B+G)+1.0/(T+y3+2.0*a))-A*(y3+a)/I*(a/(A+B+G)+1.0/(T+y3+2.0*a))+y1*(y3+a)/T*(-2.0*a/X*y1-1.0/M/T*y1)+(y3+a)/S*(sb*(cb-a/T)+(y1*cb+(y3+2.0*a)*sb)/T*(1.0+a*(y3+2.0*a)/(A+B+G))-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(B*cb*sb-a*(y1*cb+(y3+2.0*a)*sb)/T*(T*cb+y3+2.0*a)))*(1.0/T*y1-sb)-(y3+a)/(T-y1*sb+(y3+2.0*a)*cb)*(sb*a/I*y1+cb/T*(1.0+a*(y3+2.0*a)/(A+B+G))-(y1*cb+(y3+2.0*a)*sb)/I*(1.0+a*(y3+2.0*a)/(A+B+G))*y1-2.0*(y1*cb+(y3+2.0*a)*sb)/V*a*(y3+2.0*a)*y1+1.0/I/(T-y1*sb+(y3+2.0*a)*cb)*(B*cb*sb-a*(y1*cb+(y3+2.0*a)*sb)/T*(T*cb+y3+2.0*a))*y1+1.0/T/S*(B*cb*sb-a*(y1*cb+(y3+2.0*a)*sb)/T*(T*cb+y3+2.0*a))*(1.0/T*y1-sb)-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(-a*cb/T*(T*cb+y3+2.0*a)+a*(y1*cb+(y3+2.0*a)*sb)/I*(T*cb+y3+2.0*a)*y1-a*(y1*cb+(y3+2.0*a)*sb)/(A+B+G)*cb*y1)))/pi/(1.0-nu));

      e13[tid]=1.0/2.0*B1*(1.0/8.0*((2.0-2.0*nu)*(y2/O*sb/(1.0+B/O)+(y2/J*sb/(y1*(y1*cb-y3*sb)+B*cb)*y3+y2*J*K/Z*y1)/(1.0+B*(A+B+C)*K/Z)-y2/N*sb/(1.0+B/N)+(1.0/2.0*y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*(2.0*y3+4.0*a)-y2*T*K/R*y1)/(1.0+B*(A+B+G)*K/R))-y1*y2*(-1.0/L/(J-y3)*y3-1.0/J/BB*(1.0/J*y3-1.0)-1.0/2.0/I/(T+y3+2.0*a)*(2.0*y3+4.0*a)-1.0/T/M*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0))-y2*cb*(1.0/(A+B+C)*sb*y3/(J-y1*sb-y3*cb)-(J*sb-y1)/L/(J-y1*sb-y3*cb)*y3-(J*sb-y1)/J/Y*(1.0/J*y3-cb)+1.0/2.0/(A+B+G)*sb*(2.0*y3+4.0*a)/(T-y1*sb+(y3+2.0*a)*cb)-1.0/2.0*(T*sb-y1)/I/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y3+4.0*a)-(T*sb-y1)/T/S*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)))/pi/(1.0-nu)+1.0/4.0*((-2.0+2.0*nu)*(1.0-2.0*nu)*(-y2/N*sb/(1.0+B/N)+(1.0/2.0*y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*(2.0*y3+4.0*a)-y2*T*K/R*y1)/(1.0+B*(A+B+G)*K/R))*U-(1.0-2.0*nu)*y2/M*((1.0-2.0*nu-a/T)*cotb-y1/(T+y3+2.0*a)*(nu+a/T))*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+(1.0-2.0*nu)*y2/(T+y3+2.0*a)*(1.0/2.0*a/I*(2.0*y3+4.0*a)*cotb+y1/M*(nu+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+1.0/2.0*y1/(T+y3+2.0*a)*a/I*(2.0*y3+4.0*a))-(1.0-2.0*nu)*y2*cb*cotb/S*(cb+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-1.0/2.0*(1.0-2.0*nu)*y2*cb*cotb/(T-y1*sb+(y3+2.0*a)*cb)*a/I*(2.0*y3+4.0*a)+a/I*y2*cotb-3.0/2.0*a*y2*(y3+a)*cotb/V*(2.0*y3+4.0*a)+y2/T/(T+y3+2.0*a)*((-1.0+2.0*nu)*cotb+y1/(T+y3+2.0*a)*(2.0*nu+a/T)+a*y1/(A+B+G))-1.0/2.0*y2*(y3+a)/I/(T+y3+2.0*a)*((-1.0+2.0*nu)*cotb+y1/(T+y3+2.0*a)*(2.0*nu+a/T)+a*y1/(A+B+G))*(2.0*y3+4.0*a)-y2*(y3+a)/T/M*((-1.0+2.0*nu)*cotb+y1/(T+y3+2.0*a)*(2.0*nu+a/T)+a*y1/(A+B+G))*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+y2*(y3+a)/T/(T+y3+2.0*a)*(-y1/M*(2.0*nu+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)-1.0/2.0*y1/(T+y3+2.0*a)*a/I*(2.0*y3+4.0*a)-a*y1/X*(2.0*y3+4.0*a))+y2/T/(T-y1*sb+(y3+2.0*a)*cb)*(cb/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)*((1.0-2.0*nu)*cb-a/T)*cotb+(2.0-2.0*nu)*(T*sb-y1)*cb)-a*(y3+2.0*a)*cb*cotb/(A+B+G))-1.0/2.0*y2*(y3+a)/I/(T-y1*sb+(y3+2.0*a)*cb)*(cb/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)*((1.0-2.0*nu)*cb-a/T)*cotb+(2.0-2.0*nu)*(T*sb-y1)*cb)-a*(y3+2.0*a)*cb*cotb/(A+B+G))*(2.0*y3+4.0*a)-y2*(y3+a)/T/S*(cb/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)*((1.0-2.0*nu)*cb-a/T)*cotb+(2.0-2.0*nu)*(T*sb-y1)*cb)-a*(y3+2.0*a)*cb*cotb/(A+B+G))*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+y2*(y3+a)/T/(T-y1*sb+(y3+2.0*a)*cb)*(-cb/S*((T*cb+y3+2.0*a)*((1.0-2.0*nu)*cb-a/T)*cotb+(2.0-2.0*nu)*(T*sb-y1)*cb)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+cb/(T-y1*sb+(y3+2.0*a)*cb)*((1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)*((1.0-2.0*nu)*cb-a/T)*cotb+1.0/2.0*(T*cb+y3+2.0*a)*a/I*(2.0*y3+4.0*a)*cotb+1.0/2.0*(2.0-2.0*nu)/T*sb*(2.0*y3+4.0*a)*cb)-a*cb*cotb/(A+B+G)+a*(y3+2.0*a)*cb*cotb/X*(2.0*y3+4.0*a)))/pi/(1.0-nu))+1.0/2.0*B2*(1.0/8.0*((-1.0+2.0*nu)*((1.0/J*y3-1.0)/(J-y3)+(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)/(T+y3+2.0*a)-cb*((1.0/J*y3-cb)/(J-y1*sb-y3*cb)+(1.0/2.0/T*(2.0*y3+4.0*a)+cb)/(T-y1*sb+(y3+2.0*a)*cb)))+A*(-1.0/L/(J-y3)*y3-1.0/J/BB*(1.0/J*y3-1.0)-1.0/2.0/I/(T+y3+2.0*a)*(2.0*y3+4.0*a)-1.0/T/M*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0))-sb*(J*sb-y1)/J/(J-y1*sb-y3*cb)+(y1*cb-y3*sb)/(A+B+C)*sb*y3/(J-y1*sb-y3*cb)-(y1*cb-y3*sb)*(J*sb-y1)/L/(J-y1*sb-y3*cb)*y3-(y1*cb-y3*sb)*(J*sb-y1)/J/Y*(1.0/J*y3-cb)+sb*(T*sb-y1)/T/(T-y1*sb+(y3+2.0*a)*cb)+1.0/2.0*(y1*cb+(y3+2.0*a)*sb)/(A+B+G)*sb*(2.0*y3+4.0*a)/(T-y1*sb+(y3+2.0*a)*cb)-1.0/2.0*(y1*cb+(y3+2.0*a)*sb)*(T*sb-y1)/I/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y3+4.0*a)-(y1*cb+(y3+2.0*a)*sb)*(T*sb-y1)/T/S*(1.0/2.0/T*(2.0*y3+4.0*a)+cb))/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(((2.0-2.0*nu)*U+nu)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)/(T+y3+2.0*a)-((2.0-2.0*nu)*U+1.0)*cb*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)/(T-y1*sb+(y3+2.0*a)*cb))-(1.0-2.0*nu)/M*((-1.0+2.0*nu)*y1*cotb+nu*(y3+2.0*a)-a+a*y1*cotb/T+A/(T+y3+2.0*a)*(nu+a/T))*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+(1.0-2.0*nu)/(T+y3+2.0*a)*(nu-1.0/2.0*a*y1*cotb/I*(2.0*y3+4.0*a)-A/M*(nu+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)-1.0/2.0*A/(T+y3+2.0*a)*a/I*(2.0*y3+4.0*a))+(1.0-2.0*nu)*cotb/S*((y1*cb+(y3+2.0*a)*sb)*cb-a*(T*sb-y1)/T/cb)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-(1.0-2.0*nu)*cotb/(T-y1*sb+(y3+2.0*a)*cb)*(cb*sb-1.0/2.0*a/(A+B+G)*sb*(2.0*y3+4.0*a)/cb+1.0/2.0*a*(T*sb-y1)/I/cb*(2.0*y3+4.0*a))-a/I*y1*cotb+3.0/2.0*a*y1*(y3+a)*cotb/V*(2.0*y3+4.0*a)+1.0/(T+y3+2.0*a)*(2.0*nu+1.0/T*((1.0-2.0*nu)*y1*cotb+a)-A/T/(T+y3+2.0*a)*(2.0*nu+a/T)-a*A/I)-(y3+a)/M*(2.0*nu+1.0/T*((1.0-2.0*nu)*y1*cotb+a)-A/T/(T+y3+2.0*a)*(2.0*nu+a/T)-a*A/I)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+(y3+a)/(T+y3+2.0*a)*(-1.0/2.0/I*((1.0-2.0*nu)*y1*cotb+a)*(2.0*y3+4.0*a)+1.0/2.0*A/I/(T+y3+2.0*a)*(2.0*nu+a/T)*(2.0*y3+4.0*a)+A/T/M*(2.0*nu+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+1.0/2.0*A/X/(T+y3+2.0*a)*a*(2.0*y3+4.0*a)+3.0/2.0*a*A/V*(2.0*y3+4.0*a))+cotb/(T-y1*sb+(y3+2.0*a)*cb)*(-cb*sb+a*y1*(y3+2.0*a)/I/cb+(T*sb-y1)/T*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)))-(y3+a)*cotb/S*(-cb*sb+a*y1*(y3+2.0*a)/I/cb+(T*sb-y1)/T*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)))*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+(y3+a)*cotb/(T-y1*sb+(y3+2.0*a)*cb)*(a/I/cb*y1-3.0/2.0*a*y1*(y3+2.0*a)/V/cb*(2.0*y3+4.0*a)+1.0/2.0/(A+B+G)*sb*(2.0*y3+4.0*a)*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb))-1.0/2.0*(T*sb-y1)/I*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb))*(2.0*y3+4.0*a)+(T*sb-y1)/T*(-(1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+(T*cb+y3+2.0*a)/S*(1.0+a/T/cb)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+1.0/2.0*(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I/cb*(2.0*y3+4.0*a))))/pi/(1.0-nu))+1.0/2.0*B3*(1.0/8.0*y2*sb*(1.0/(A+B+C)*sb*y3/(J-y1*sb-y3*cb)-(J*sb-y1)/L/(J-y1*sb-y3*cb)*y3-(J*sb-y1)/J/Y*(1.0/J*y3-cb)+1.0/2.0/(A+B+G)*sb*(2.0*y3+4.0*a)/(T-y1*sb+(y3+2.0*a)*cb)-1.0/2.0*(T*sb-y1)/I/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y3+4.0*a)-(T*sb-y1)/T/S*(1.0/2.0/T*(2.0*y3+4.0*a)+cb))/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(-y2/M*(1.0+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)-1.0/2.0*y2/(T+y3+2.0*a)*a/I*(2.0*y3+4.0*a)+y2*cb/S*(cb+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+1.0/2.0*y2*cb/(T-y1*sb+(y3+2.0*a)*cb)*a/I*(2.0*y3+4.0*a))-y2/T*(a/(A+B+G)+1.0/(T+y3+2.0*a))+1.0/2.0*y2*(y3+a)/I*(a/(A+B+G)+1.0/(T+y3+2.0*a))*(2.0*y3+4.0*a)-y2*(y3+a)/T*(-a/X*(2.0*y3+4.0*a)-1.0/M*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0))+y2*cb/T/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))-1.0/2.0*y2*(y3+a)*cb/I/(T-y1*sb+(y3+2.0*a)*cb)*((T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))*(2.0*y3+4.0*a)-y2*(y3+a)*cb/T/S*((T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+y2*(y3+a)*cb/T/(T-y1*sb+(y3+2.0*a)*cb)*((1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(T*cb+y3+2.0*a)/S*(cb+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-1.0/2.0*(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*(2.0*y3+4.0*a)+a/(A+B+G)-a*(y3+2.0*a)/X*(2.0*y3+4.0*a)))/pi/(1.0-nu))+1.0/2.0*B1*(1.0/8.0*y2*(-1.0/L*y1+1.0/I*y1-cb*(1.0/(A+B+C)*cb*y1/(J-y1*sb-y3*cb)-(J*cb-y3)/L/(J-y1*sb-y3*cb)*y1-(J*cb-y3)/J/Y*(1.0/J*y1-sb)-1.0/(A+B+G)*cb*y1/(T-y1*sb+(y3+2.0*a)*cb)+(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*y1+(T*cb+y3+2.0*a)/T/S*(1.0/T*y1-sb)))/pi/(1.0-nu)+1.0/4.0*((2.0-2.0*nu)*((1.0-2.0*nu)*(y2/A/(1.0+B/A)-y2/N*cb/(1.0+B/N)+(y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*y1-y2*T*sb/R*(2.0*y1*cb+(y3+2.0*a)*sb))/(1.0+B*(A+B+G)*K/R))*cotb-y1/M*(2.0*nu+a/T)/T*y2-y2/(T+y3+2.0*a)*a/I*y1+y2*cb/S*(cb+a/T)*(1.0/T*y1-sb)+y2*cb/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y1)-y2*(y3+a)/I*(2.0*nu/(T+y3+2.0*a)+a/(A+B+G))*y1+y2*(y3+a)/T*(-2.0*nu/M/T*y1-2.0*a/X*y1)-y2*(y3+a)*cb/I/(T-y1*sb+(y3+2.0*a)*cb)*(1.0-2.0*nu-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-a*(y3+2.0*a)/(A+B+G))*y1-y2*(y3+a)*cb/T/S*(1.0-2.0*nu-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-a*(y3+2.0*a)/(A+B+G))*(1.0/T*y1-sb)+y2*(y3+a)*cb/T/(T-y1*sb+(y3+2.0*a)*cb)*(-1.0/T*cb*y1/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+(T*cb+y3+2.0*a)/S*(cb+a/T)*(1.0/T*y1-sb)+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y1+2.0*a*(y3+2.0*a)/X*y1))/pi/(1.0-nu))+1.0/2.0*B2*(1.0/8.0*((-1.0+2.0*nu)*sb*((1.0/J*y1-sb)/(J-y1*sb-y3*cb)-(1.0/T*y1-sb)/(T-y1*sb+(y3+2.0*a)*cb))-1.0/J+1.0/T-y1*(-1.0/L*y1+1.0/I*y1)+cb*(J*cb-y3)/J/(J-y1*sb-y3*cb)+(y1*cb-y3*sb)/(A+B+C)*cb*y1/(J-y1*sb-y3*cb)-(y1*cb-y3*sb)*(J*cb-y3)/L/(J-y1*sb-y3*cb)*y1-(y1*cb-y3*sb)*(J*cb-y3)/J/Y*(1.0/J*y1-sb)-cb*(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb)-(y1*cb+(y3+2.0*a)*sb)/(A+B+G)*cb*y1/(T-y1*sb+(y3+2.0*a)*cb)+(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*y1+(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/T/S*(1.0/T*y1-sb))/pi/(1.0-nu)+1.0/4.0*((-2.0+2.0*nu)*(1.0-2.0*nu)*cotb*(1.0/T*y1/(T+y3+2.0*a)-cb*(1.0/T*y1-sb)/(T-y1*sb+(y3+2.0*a)*cb))-(2.0-2.0*nu)/(T+y3+2.0*a)*(2.0*nu+a/T)+(2.0-2.0*nu)*A/M*(2.0*nu+a/T)/T+(2.0-2.0*nu)*A/(T+y3+2.0*a)*a/I+(2.0-2.0*nu)*cb/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(2.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)/S*(cb+a/T)*(1.0/T*y1-sb)-(2.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y1-(y3+a)/I*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/(A+B+G))*y1+(y3+a)/T*(-2.0*nu/(T+y3+2.0*a)+2.0*nu*A/M/T-a/(A+B+G)+2.0*a*A/X)+(y3+a)/S*(cb*sb+(T*cb+y3+2.0*a)*cotb/T*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb))+a/T*(sb-(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)/(A+B+G)-(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb)))*(1.0/T*y1-sb)-(y3+a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/(A+B+G)*cb*y1*cotb*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb))-(T*cb+y3+2.0*a)*cotb/I*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb))*y1+(T*cb+y3+2.0*a)*cotb/T*(-1.0/T*cb*y1/(T-y1*sb+(y3+2.0*a)*cb)+(T*cb+y3+2.0*a)/S*(1.0/T*y1-sb))-a/I*(sb-(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)/(A+B+G)-(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb))*y1+a/T*(-(y3+2.0*a)*cb/(A+B+G)+2.0*(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)/X*y1-cb*(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb)-(y1*cb+(y3+2.0*a)*sb)/(A+B+G)*cb*y1/(T-y1*sb+(y3+2.0*a)*cb)+(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*y1+(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/T/S*(1.0/T*y1-sb))))/pi/(1.0-nu))+1.0/2.0*B3*(1.0/8.0*((2.0-2.0*nu)*(-y2/O*cb/(1.0+B/O)+(y2/J*sb/(y1*(y1*cb-y3*sb)+B*cb)*y1-y2*J*sb/Z*(2.0*y1*cb-y3*sb))/(1.0+B*(A+B+C)*K/Z)+y2/N*cb/(1.0+B/N)-(y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*y1-y2*T*sb/R*(2.0*y1*cb+(y3+2.0*a)*sb))/(1.0+B*(A+B+G)*K/R))+y2*sb*(1.0/(A+B+C)*cb*y1/(J-y1*sb-y3*cb)-(J*cb-y3)/L/(J-y1*sb-y3*cb)*y1-(J*cb-y3)/J/Y*(1.0/J*y1-sb)-1.0/(A+B+G)*cb*y1/(T-y1*sb+(y3+2.0*a)*cb)+(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*y1+(T*cb+y3+2.0*a)/T/S*(1.0/T*y1-sb)))/pi/(1.0-nu)+1.0/4.0*((2.0-2.0*nu)*(y2/A/(1.0+B/A)-y2/N*cb/(1.0+B/N)+(y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*y1-y2*T*sb/R*(2.0*y1*cb+(y3+2.0*a)*sb))/(1.0+B*(A+B+G)*K/R))-(2.0-2.0*nu)*y2*sb/S*(cb+a/T)*(1.0/T*y1-sb)-(2.0-2.0*nu)*y2*sb/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y1-y2*(y3+a)*sb/I/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))*y1-y2*(y3+a)*sb/T/S*(1.0+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))*(1.0/T*y1-sb)+y2*(y3+a)*sb/T/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/T*cb*y1/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(T*cb+y3+2.0*a)/S*(cb+a/T)*(1.0/T*y1-sb)-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y1-2.0*a*(y3+2.0*a)/X*y1))/pi/(1.0-nu));

      e23[tid]=1.0/2.0*B1*(1.0/8.0*((1.0-2.0*nu)*((1.0/J*y3-1.0)/(J-y3)+(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)/(T+y3+2.0*a)-cb*((1.0/J*y3-cb)/(J-y1*sb-y3*cb)+(1.0/2.0/T*(2.0*y3+4.0*a)+cb)/(T-y1*sb+(y3+2.0*a)*cb)))-B*(-1.0/L/(J-y3)*y3-1.0/J/BB*(1.0/J*y3-1.0)-1.0/2.0/I/(T+y3+2.0*a)*(2.0*y3+4.0*a)-1.0/T/M*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)-cb*(-1.0/L/(J-y1*sb-y3*cb)*y3-1.0/J/Y*(1.0/J*y3-cb)-1.0/2.0/I/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y3+4.0*a)-1.0/T/S*(1.0/2.0/T*(2.0*y3+4.0*a)+cb))))/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(((2.0-2.0*nu)*U-nu)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)/(T+y3+2.0*a)-((2.0-2.0*nu)*U+1.0-2.0*nu)*cb*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)/(T-y1*sb+(y3+2.0*a)*cb))+(1.0-2.0*nu)/M*(y1*cotb*(1.0-2.0*nu-a/T)+nu*(y3+2.0*a)-a+B/(T+y3+2.0*a)*(nu+a/T))*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)-(1.0-2.0*nu)/(T+y3+2.0*a)*(1.0/2.0*a*y1*cotb/I*(2.0*y3+4.0*a)+nu-B/M*(nu+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)-1.0/2.0*B/(T+y3+2.0*a)*a/I*(2.0*y3+4.0*a))-(1.0-2.0*nu)*sb*cotb/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+(1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb/S*(cb+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+1.0/2.0*(1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb/(T-y1*sb+(y3+2.0*a)*cb)*a/I*(2.0*y3+4.0*a)-a/I*y1*cotb+3.0/2.0*a*y1*(y3+a)*cotb/V*(2.0*y3+4.0*a)+1.0/(T+y3+2.0*a)*(-2.0*nu+1.0/T*((1.0-2.0*nu)*y1*cotb-a)+B/T/(T+y3+2.0*a)*(2.0*nu+a/T)+a*B/I)-(y3+a)/M*(-2.0*nu+1.0/T*((1.0-2.0*nu)*y1*cotb-a)+B/T/(T+y3+2.0*a)*(2.0*nu+a/T)+a*B/I)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+(y3+a)/(T+y3+2.0*a)*(-1.0/2.0/I*((1.0-2.0*nu)*y1*cotb-a)*(2.0*y3+4.0*a)-1.0/2.0*B/I/(T+y3+2.0*a)*(2.0*nu+a/T)*(2.0*y3+4.0*a)-B/T/M*(2.0*nu+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)-1.0/2.0*B/X/(T+y3+2.0*a)*a*(2.0*y3+4.0*a)-3.0/2.0*a*B/V*(2.0*y3+4.0*a))+1.0/(T-y1*sb+(y3+2.0*a)*cb)*(Q-1.0/T*((1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb+a*cb)+a*(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)*cotb/I-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(B*Q-a*(y1*cb+(y3+2.0*a)*sb)*cotb/T*(T*cb+y3+2.0*a)))-(y3+a)/S*(Q-1.0/T*((1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb+a*cb)+a*(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)*cotb/I-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(B*Q-a*(y1*cb+(y3+2.0*a)*sb)*cotb/T*(T*cb+y3+2.0*a)))*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+(y3+a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/2.0/I*((1.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)*cotb+a*cb)*(2.0*y3+4.0*a)-1.0/T*(1.0-2.0*nu)*sb*cotb+a*(y1*cb+(y3+2.0*a)*sb)*cotb/I+a*(y3+2.0*a)*sb*cotb/I-3.0/2.0*a*(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)*cotb/V*(2.0*y3+4.0*a)+1.0/2.0/I/(T-y1*sb+(y3+2.0*a)*cb)*(B*Q-a*(y1*cb+(y3+2.0*a)*sb)*cotb/T*(T*cb+y3+2.0*a))*(2.0*y3+4.0*a)+1.0/T/S*(B*Q-a*(y1*cb+(y3+2.0*a)*sb)*cotb/T*(T*cb+y3+2.0*a))*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(-a*sb*cotb/T*(T*cb+y3+2.0*a)+1.0/2.0*a*(y1*cb+(y3+2.0*a)*sb)*cotb/I*(T*cb+y3+2.0*a)*(2.0*y3+4.0*a)-a*(y1*cb+(y3+2.0*a)*sb)*cotb/T*(1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0))))/pi/(1.0-nu))+1.0/2.0*B2*(1.0/8.0*((2.0-2.0*nu)*(y2/O*sb/(1.0+B/O)+(y2/J*sb/(y1*(y1*cb-y3*sb)+B*cb)*y3+y2*J*K/Z*y1)/(1.0+B*(A+B+C)*K/Z)-y2/N*sb/(1.0+B/N)+(1.0/2.0*y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*(2.0*y3+4.0*a)-y2*T*K/R*y1)/(1.0+B*(A+B+G)*K/R))+y1*y2*(-1.0/L/(J-y3)*y3-1.0/J/BB*(1.0/J*y3-1.0)-1.0/2.0/I/(T+y3+2.0*a)*(2.0*y3+4.0*a)-1.0/T/M*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0))-y2*(-sb/J/(J-y1*sb-y3*cb)-(y1*cb-y3*sb)/L/(J-y1*sb-y3*cb)*y3-(y1*cb-y3*sb)/J/Y*(1.0/J*y3-cb)+sb/T/(T-y1*sb+(y3+2.0*a)*cb)-1.0/2.0*(y1*cb+(y3+2.0*a)*sb)/I/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y3+4.0*a)-(y1*cb+(y3+2.0*a)*sb)/T/S*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)))/pi/(1.0-nu)+1.0/4.0*((2.0-2.0*nu)*(1.0-2.0*nu)*(-y2/N*sb/(1.0+B/N)+(1.0/2.0*y2/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)*(2.0*y3+4.0*a)-y2*T*K/R*y1)/(1.0+B*(A+B+G)*K/R))*U-(1.0-2.0*nu)*y2/M*((-1.0+2.0*nu+a/T)*cotb+y1/(T+y3+2.0*a)*(nu+a/T))*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+(1.0-2.0*nu)*y2/(T+y3+2.0*a)*(-1.0/2.0*a/I*(2.0*y3+4.0*a)*cotb-y1/M*(nu+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)-1.0/2.0*y1/(T+y3+2.0*a)*a/I*(2.0*y3+4.0*a))+(1.0-2.0*nu)*y2*cotb/S*(1.0+a/T/cb)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+1.0/2.0*(1.0-2.0*nu)*y2*cotb/(T-y1*sb+(y3+2.0*a)*cb)*a/I/cb*(2.0*y3+4.0*a)-a/I*y2*cotb+3.0/2.0*a*y2*(y3+a)*cotb/V*(2.0*y3+4.0*a)+y2/T/(T+y3+2.0*a)*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/T*(1.0/T+1.0/(T+y3+2.0*a)))-1.0/2.0*y2*(y3+a)/I/(T+y3+2.0*a)*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/T*(1.0/T+1.0/(T+y3+2.0*a)))*(2.0*y3+4.0*a)-y2*(y3+a)/T/M*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/T*(1.0/T+1.0/(T+y3+2.0*a)))*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+y2*(y3+a)/T/(T+y3+2.0*a)*(2.0*nu*y1/M*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+1.0/2.0*a*y1/I*(1.0/T+1.0/(T+y3+2.0*a))*(2.0*y3+4.0*a)-a*y1/T*(-1.0/2.0/I*(2.0*y3+4.0*a)-1.0/M*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)))+y2*cotb/T/(T-y1*sb+(y3+2.0*a)*cb)*((-2.0+2.0*nu)*cb+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+a*(y3+2.0*a)/(A+B+G)/cb)-1.0/2.0*y2*(y3+a)*cotb/I/(T-y1*sb+(y3+2.0*a)*cb)*((-2.0+2.0*nu)*cb+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+a*(y3+2.0*a)/(A+B+G)/cb)*(2.0*y3+4.0*a)-y2*(y3+a)*cotb/T/S*((-2.0+2.0*nu)*cb+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)+a*(y3+2.0*a)/(A+B+G)/cb)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)+y2*(y3+a)*cotb/T/(T-y1*sb+(y3+2.0*a)*cb)*((1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+a/T/cb)-(T*cb+y3+2.0*a)/S*(1.0+a/T/cb)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-1.0/2.0*(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I/cb*(2.0*y3+4.0*a)+a/(A+B+G)/cb-a*(y3+2.0*a)/X/cb*(2.0*y3+4.0*a)))/pi/(1.0-nu))+1.0/2.0*B3*(1.0/8.0*((1.0-2.0*nu)*sb*((1.0/J*y3-cb)/(J-y1*sb-y3*cb)+(1.0/2.0/T*(2.0*y3+4.0*a)+cb)/(T-y1*sb+(y3+2.0*a)*cb))-B*sb*(-1.0/L/(J-y1*sb-y3*cb)*y3-1.0/J/Y*(1.0/J*y3-cb)-1.0/2.0/I/(T-y1*sb+(y3+2.0*a)*cb)*(2.0*y3+4.0*a)-1.0/T/S*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)))/pi/(1.0-nu)+1.0/4.0*((1.0-2.0*nu)*(-sb*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)/(T-y1*sb+(y3+2.0*a)*cb)+y1/M*(1.0+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0)+1.0/2.0*y1/(T+y3+2.0*a)*a/I*(2.0*y3+4.0*a)+sb/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(y1*cb+(y3+2.0*a)*sb)/S*(cb+a/T)*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-1.0/2.0*(y1*cb+(y3+2.0*a)*sb)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*(2.0*y3+4.0*a))+y1/T*(a/(A+B+G)+1.0/(T+y3+2.0*a))-1.0/2.0*y1*(y3+a)/I*(a/(A+B+G)+1.0/(T+y3+2.0*a))*(2.0*y3+4.0*a)+y1*(y3+a)/T*(-a/X*(2.0*y3+4.0*a)-1.0/M*(1.0/2.0/T*(2.0*y3+4.0*a)+1.0))-1.0/(T-y1*sb+(y3+2.0*a)*cb)*(sb*(cb-a/T)+(y1*cb+(y3+2.0*a)*sb)/T*(1.0+a*(y3+2.0*a)/(A+B+G))-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(B*cb*sb-a*(y1*cb+(y3+2.0*a)*sb)/T*(T*cb+y3+2.0*a)))+(y3+a)/S*(sb*(cb-a/T)+(y1*cb+(y3+2.0*a)*sb)/T*(1.0+a*(y3+2.0*a)/(A+B+G))-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(B*cb*sb-a*(y1*cb+(y3+2.0*a)*sb)/T*(T*cb+y3+2.0*a)))*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-(y3+a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/2.0*sb*a/I*(2.0*y3+4.0*a)+sb/T*(1.0+a*(y3+2.0*a)/(A+B+G))-1.0/2.0*(y1*cb+(y3+2.0*a)*sb)/I*(1.0+a*(y3+2.0*a)/(A+B+G))*(2.0*y3+4.0*a)+(y1*cb+(y3+2.0*a)*sb)/T*(a/(A+B+G)-a*(y3+2.0*a)/X*(2.0*y3+4.0*a))+1.0/2.0/I/(T-y1*sb+(y3+2.0*a)*cb)*(B*cb*sb-a*(y1*cb+(y3+2.0*a)*sb)/T*(T*cb+y3+2.0*a))*(2.0*y3+4.0*a)+1.0/T/S*(B*cb*sb-a*(y1*cb+(y3+2.0*a)*sb)/T*(T*cb+y3+2.0*a))*(1.0/2.0/T*(2.0*y3+4.0*a)+cb)-1.0/T/(T-y1*sb+(y3+2.0*a)*cb)*(-a*sb/T*(T*cb+y3+2.0*a)+1.0/2.0*a*(y1*cb+(y3+2.0*a)*sb)/I*(T*cb+y3+2.0*a)*(2.0*y3+4.0*a)-a*(y1*cb+(y3+2.0*a)*sb)/T*(1.0/2.0/T*cb*(2.0*y3+4.0*a)+1.0))))/pi/(1.0-nu))+1.0/2.0*B1*(1.0/8.0*(1.0/J-1.0/T-cb*((J*cb-y3)/J/(J-y1*sb-y3*cb)-(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb)))/pi/(1.0-nu)+1.0/8.0*y2*(-1.0/L*y2+1.0/I*y2-cb*(1.0/(A+B+C)*cb*y2/(J-y1*sb-y3*cb)-(J*cb-y3)/L/(J-y1*sb-y3*cb)*y2-(J*cb-y3)/(A+B+C)/Y*y2-1.0/(A+B+G)*cb*y2/(T-y1*sb+(y3+2.0*a)*cb)+(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*y2+(T*cb+y3+2.0*a)/(A+B+G)/S*y2))/pi/(1.0-nu)+1.0/4.0*((2.0-2.0*nu)*((1.0-2.0*nu)*(-1.0/y1/(1.0+B/A)+1.0/(y1*cb+(y3+2.0*a)*sb)/(1.0+B/N)+(T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)+B/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)-2.0*B*T*sb/R*cb)/(1.0+B*(A+B+G)*K/R))*cotb+1.0/(T+y3+2.0*a)*(2.0*nu+a/T)-B/M*(2.0*nu+a/T)/T-B/(T+y3+2.0*a)*a/I-cb/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+B*cb/S*(cb+a/T)/T+B*cb/(T-y1*sb+(y3+2.0*a)*cb)*a/I)+(y3+a)/T*(2.0*nu/(T+y3+2.0*a)+a/(A+B+G))-B*(y3+a)/I*(2.0*nu/(T+y3+2.0*a)+a/(A+B+G))+y2*(y3+a)/T*(-2.0*nu/M/T*y2-2.0*a/X*y2)+(y3+a)*cb/T/(T-y1*sb+(y3+2.0*a)*cb)*(1.0-2.0*nu-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-a*(y3+2.0*a)/(A+B+G))-B*(y3+a)*cb/I/(T-y1*sb+(y3+2.0*a)*cb)*(1.0-2.0*nu-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-a*(y3+2.0*a)/(A+B+G))-B*(y3+a)*cb/(A+B+G)/S*(1.0-2.0*nu-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-a*(y3+2.0*a)/(A+B+G))+y2*(y3+a)*cb/T/(T-y1*sb+(y3+2.0*a)*cb)*(-1.0/T*cb*y2/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+(T*cb+y3+2.0*a)/S*(cb+a/T)/T*y2+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y2+2.0*a*(y3+2.0*a)/X*y2))/pi/(1.0-nu))+1.0/2.0*B2*(1.0/8.0*((-1.0+2.0*nu)*sb*(1.0/J*y2/(J-y1*sb-y3*cb)-1.0/T*y2/(T-y1*sb+(y3+2.0*a)*cb))-y1*(-1.0/L*y2+1.0/I*y2)+(y1*cb-y3*sb)/(A+B+C)*cb*y2/(J-y1*sb-y3*cb)-(y1*cb-y3*sb)*(J*cb-y3)/L/(J-y1*sb-y3*cb)*y2-(y1*cb-y3*sb)*(J*cb-y3)/(A+B+C)/Y*y2-(y1*cb+(y3+2.0*a)*sb)/(A+B+G)*cb*y2/(T-y1*sb+(y3+2.0*a)*cb)+(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*y2+(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/(A+B+G)/S*y2)/pi/(1.0-nu)+1.0/4.0*((-2.0+2.0*nu)*(1.0-2.0*nu)*cotb*(1.0/T*y2/(T+y3+2.0*a)-cb/T*y2/(T-y1*sb+(y3+2.0*a)*cb))+(2.0-2.0*nu)*y1/M*(2.0*nu+a/T)/T*y2+(2.0-2.0*nu)*y1/(T+y3+2.0*a)*a/I*y2-(2.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)/S*(cb+a/T)/T*y2-(2.0-2.0*nu)*(y1*cb+(y3+2.0*a)*sb)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y2-(y3+a)/I*((1.0-2.0*nu)*cotb-2.0*nu*y1/(T+y3+2.0*a)-a*y1/(A+B+G))*y2+(y3+a)/T*(2.0*nu*y1/M/T*y2+2.0*a*y1/X*y2)+(y3+a)/S*(cb*sb+(T*cb+y3+2.0*a)*cotb/T*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb))+a/T*(sb-(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)/(A+B+G)-(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb)))/T*y2-(y3+a)/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/(A+B+G)*cb*y2*cotb*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb))-(T*cb+y3+2.0*a)*cotb/I*((2.0-2.0*nu)*cb-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb))*y2+(T*cb+y3+2.0*a)*cotb/T*(-cb/T*y2/(T-y1*sb+(y3+2.0*a)*cb)+(T*cb+y3+2.0*a)/S/T*y2)-a/I*(sb-(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)/(A+B+G)-(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb))*y2+a/T*(2.0*(y3+2.0*a)*(y1*cb+(y3+2.0*a)*sb)/X*y2-(y1*cb+(y3+2.0*a)*sb)/(A+B+G)*cb*y2/(T-y1*sb+(y3+2.0*a)*cb)+(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*y2+(y1*cb+(y3+2.0*a)*sb)*(T*cb+y3+2.0*a)/(A+B+G)/S*y2)))/pi/(1.0-nu))+1.0/2.0*B3*(1.0/8.0*((2.0-2.0*nu)*(1.0/(y1*cb-y3*sb)/(1.0+B/O)+(J*sb/(y1*(y1*cb-y3*sb)+B*cb)+B/J*sb/(y1*(y1*cb-y3*sb)+B*cb)-2.0*B*J*sb/Z*cb)/(1.0+B*(A+B+C)*K/Z)-1.0/(y1*cb+(y3+2.0*a)*sb)/(1.0+B/N)-(T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)+B/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)-2.0*B*T*sb/R*cb)/(1.0+B*(A+B+G)*K/R))+sb*((J*cb-y3)/J/(J-y1*sb-y3*cb)-(T*cb+y3+2.0*a)/T/(T-y1*sb+(y3+2.0*a)*cb))+y2*sb*(1.0/(A+B+C)*cb*y2/(J-y1*sb-y3*cb)-(J*cb-y3)/L/(J-y1*sb-y3*cb)*y2-(J*cb-y3)/(A+B+C)/Y*y2-1.0/(A+B+G)*cb*y2/(T-y1*sb+(y3+2.0*a)*cb)+(T*cb+y3+2.0*a)/I/(T-y1*sb+(y3+2.0*a)*cb)*y2+(T*cb+y3+2.0*a)/(A+B+G)/S*y2))/pi/(1.0-nu)+1.0/4.0*((2.0-2.0*nu)*(-1.0/y1/(1.0+B/A)+1.0/(y1*cb+(y3+2.0*a)*sb)/(1.0+B/N)+(T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)+B/T*sb/(y1*(y1*cb+(y3+2.0*a)*sb)+B*cb)-2.0*B*T*sb/R*cb)/(1.0+B*(A+B+G)*K/R))+(2.0-2.0*nu)*sb/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(2.0-2.0*nu)*B*sb/S*(cb+a/T)/T-(2.0-2.0*nu)*B*sb/(T-y1*sb+(y3+2.0*a)*cb)*a/I+(y3+a)*sb/T/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))-B*(y3+a)*sb/I/(T-y1*sb+(y3+2.0*a)*cb)*(1.0+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))-B*(y3+a)*sb/(A+B+G)/S*(1.0+(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)+a*(y3+2.0*a)/(A+B+G))+y2*(y3+a)*sb/T/(T-y1*sb+(y3+2.0*a)*cb)*(1.0/T*cb*y2/(T-y1*sb+(y3+2.0*a)*cb)*(cb+a/T)-(T*cb+y3+2.0*a)/S*(cb+a/T)/T*y2-(T*cb+y3+2.0*a)/(T-y1*sb+(y3+2.0*a)*cb)*a/I*y2-2.0*a*(y3+2.0*a)/X*y2))/pi/(1.0-nu));
   
}
"""
     # Compile the CUDA Kernel at runtime and cahche the result for later reuse
     advs_kernel_source_module = nvcc.SourceModule( advs_kernel_source )
     # Get a handle to the compiled CUDA kernel
     advs_kernel = advs_kernel_source_module.get_function( "advs_kernel" )
     # On the host, define the vectors and kernel parameters

     #n_blocks  = 16384      # Number of thread blocks
     N=np.float(len(y1vec))
     n_TPB     = int(32)         # Number of threads per block - make it a multiple of 32
     n_blocks  = int(np.ceil(N/n_TPB))  #ceil( N / n_TPB )      # Number of thread blocks
     #n_blocks  = int(n_blocks)  
     # Allocate memory on the device and copy from host to device
     #should these be n_TPB instead of N?
     e11=np.double(np.zeros(N))
     d_e11 = cu.mem_alloc( e11.nbytes )
     e22=np.double(np.zeros(N))
     d_e22 = cu.mem_alloc( e22.nbytes )
     e33=np.double(np.zeros(N))
     d_e33 = cu.mem_alloc( e33.nbytes )
     e12=np.double(np.zeros(N))
     d_e12 = cu.mem_alloc( e12.nbytes )
     e13=np.double(np.zeros(N))
     d_e13 = cu.mem_alloc( e13.nbytes )
     e23=np.double(np.zeros(N))
     d_e23 = cu.mem_alloc( e23.nbytes ) 
     #pad inputs to have a length that is a multiple of 32
     y1vec=(np.double(y1vec))
     y2vec=(np.double(y2vec))
     y3vec=(np.double(y3vec))
     mult=np.ceil(len(y1vec)/32.)
     length=len(y1vec)
     y1vec = np.double(y1vec)
     y2vec = np.double(y2vec)
     y3vec = np.double(y3vec)
     y1vec = np.append(y1vec, np.double(np.zeros(32*mult-length)))
     y2vec = np.append(y2vec, np.double(np.zeros(32*mult-length)))
     y3vec = np.append(y3vec, np.double(np.zeros(32*mult-length)))
     d_y1vec = cu.mem_alloc( y1vec.nbytes )
     d_y2vec = cu.mem_alloc( y2vec.nbytes )
     d_y3vec = cu.mem_alloc( y3vec.nbytes )
     
     a = np.double(a)
     b = np.double(b)
     nu = np.double(nu)
     B1 = np.double(B1)
     B2 = np.double(B2)
     B3 = np.double(B3)
     d_a = cu.mem_alloc( a.nbytes )
     d_b = cu.mem_alloc( b.nbytes )
     d_B1 = cu.mem_alloc( B1.nbytes )
     d_B2 = cu.mem_alloc( B2.nbytes )
     d_B3 = cu.mem_alloc( B3.nbytes )
     cu.memcpy_htod( d_e11, e11 )
     cu.memcpy_htod( d_e22, e22 )
     cu.memcpy_htod( d_e33, e33 )
     cu.memcpy_htod( d_e12, e12 )
     cu.memcpy_htod( d_e13, e13 )
     cu.memcpy_htod( d_e23, e23 )
     cu.memcpy_htod( d_a, a )
     cu.memcpy_htod( d_b, b )
     cu.memcpy_htod( d_B1, B1)
     cu.memcpy_htod( d_B2, B2 )
     cu.memcpy_htod( d_B3, B3 )
     cu.memcpy_htod( d_y1vec, y1vec )
     cu.memcpy_htod( d_y2vec, y2vec )
     cu.memcpy_htod( d_y3vec, y3vec )
     start_time = cu.Event()
     end_time = cu.Event()
     start_time.record()
     advs_kernel(d_e11,d_e22, d_e33, d_e12, d_e13, d_e23, d_y1vec, d_y2vec, d_y3vec, d_a, d_b, nu, d_B1, d_B2, d_B3, block=(n_TPB,1,1), grid=(n_blocks,1))
     end_time.record()
     end_time.synchronize()
     time_delta_seconds = start_time.time_till(end_time) * 1e-3
     cu.memcpy_dtoh( e11, d_e11 )
     cu.memcpy_dtoh( e22, d_e22 )
     cu.memcpy_dtoh( e33, d_e33 )
     cu.memcpy_dtoh( e12, d_e12 )
     cu.memcpy_dtoh( e13, d_e13 )
     cu.memcpy_dtoh( e23, d_e23 )
     
     return e11, e22, e33, e12, e13, e23, time_delta_seconds

